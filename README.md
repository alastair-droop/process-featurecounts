# Process featureCounts Output

This script processes the output files generated by [featureCounts](http://subread.sourceforge.net/) to a simpler (and smaller) counts matrix.

## Usage

~~~
usage: process-featurecounts [-h] [-v] [-s HEADER_SUFFIX] [-r] <file>

Reformat featureCounts output files

positional arguments:
  <file>                input featureCounts file

optional arguments:
  -h, --help            show this help message and exit
  -v, --version         show program's version number and exit
  -s HEADER_SUFFIX, --header-suffix HEADER_SUFFIX
                        header suffix to remove
  -r, --clean-rows      trim accession version data from row IDs
~~~

## Header Trimming

The file header from featureCounts line contains the path of the input BAM file. process-featurecounts performs two trimming steps on this:

1. The file path is trimmed, leaving only the filename;
2. The filename is then processed using the regular expression string provided with `--header-suffix`. By default this is `.bam`, which will trim the file extension. The returned sample header is determined by the first returned regular expression group (if specified).

## Row cleaning

If specified with `-r` or `--clean-rows` then the row IDs are cleaned. Each row is trimmed using the regular expression `(\S+)(?:\\.\S+)`. This removes the accession version number. **NB**: This process may well yield non-unique row IDs, which will cause downstream issues.

## Returned Columns

The metadata columns associated with each read are trimmed, and only the counts columns are returned.

